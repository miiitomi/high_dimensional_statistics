\documentclass[aspectratio=169, dvipdfmx]{beamer}
\usetheme{Boadilla}
\usepackage{amsmath, amssymb, amsthm, color, latexsym}
\usefonttheme{professionalfonts}

\def\qed{\hfill $\Box$}
\def\endexample{\hfill $\clubsuit$}
\newcommand{\ex}{\mathbb{E}}
\newcommand{\var}{\mathrm{var}}

\title{3. Concentration of measure}
\author{Yoji Tomita}
\date{May 12, 2021}

\begin{document}

\maketitle

\begin{frame}{Introduction}
\begin{itemize}
    \item 2章を前提として, この章ではtail boundやconcentration inequalitiesを求めるためのより上級的な手法を紹介する.
    \item 3.1：Concentration by entropic techniques
    \item 3.2：A geometric perspective on concentration
    \item 3.3：Wasserstein distances and information inequalities
    \item 3.4：Tail bounds for empirical processes
\end{itemize}
\end{frame}

\section{3.1 Concentration by entropic techniques}

\begin{frame}{3.1 Concentration by entropic techniques}
\begin{itemize}
    \item エントロピーと, 集中不等式導出のためのその関連テクニックに関する議論から始める.
\end{itemize}
\end{frame}

\subsection{3.1.1 Entropy and its properties}
\begin{frame}{3.1.1 Entropy and its properties}
\begin{itemize}
    \item 凸関数 $\phi:\mathbb{R} \to \mathbb{R}$と, 確率変数$X\sim \mathbb{P}$に対して, $\phi$-entropyを
    \[\mathbb{H}_\phi(X) := \ex[\phi(X)] - \phi(\ex[X])\]
    とする($X, \phi(X)$の有限期待値は仮定).\\
    　
    \item Jensenの不等式より, $\phi$-entropyは非負.
    \item これは$X$のばらつき加減を表す.
    \begin{itemize}
        \item 極端な場合, $X$がa.s.で期待値と一致するなら, $\mathbb{H}_\phi(X) = 0$.
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item 例1：$\phi(u) = u^2$なら$\mathbb{H}_\phi(X)$は分散.
        \[ \mathbb{H}_\phi(X) = \ex[X^2] - (\ex[X])^2 = \var(X).\]
    　
    \item 例2：$\phi(u) = -\log u$, $Z := e^{\lambda X}$とすると,
        \[ \mathbb{H}_\phi(e^{\lambda X})  = -\lambda \ex[X] + \log \ex[e^{\lambda X}] = \log\ex[e^{\lambda(X-\ex[X])}]\]
        となり, centerd cumulant generating functionとなる.
\end{itemize}
\end{frame}

\begin{frame}
    \begin{itemize}
        \item この章では, 次の凸関数$\phi:[0,\infty)\to\mathbb{R}$に対するentropyを考える.
        \[\phi(u) := 
            \begin{cases}
                u\log u & \mathrm{for} \ u > 0\\
                0       & \mathrm{for} \ u = 0
            \end{cases}.\tag{3.1}\label{3.1}
        \]
        非負確率変数$Z$に対して, $\phi$-entropyは
        \[ \mathbb{H}(Z) = \ex[Z\log Z] - \ex[Z]\log\ex[Z], \tag{3.2}\label{3.2}\]
        となる(ただし関連する期待値の存在は仮定). 
        \begin{itemize}
            \item Shannon entropyやKullback-Leibler divergenceと関連がある(see Exercise 3.1).
            \item 以後このentropyを考えるので, $\mathbb{H}_\phi$のsubscrript $\phi$は省略.
        \end{itemize}
        　
        \item $Z = e^{\lambda X}$とすると, $\mathbb{H}(e^{\lambda X})$は$X$のモーメント母関数$\varphi_X(\lambda)=\ex[e^{\lambda X}]$とその導関数$\varphi_X'(\lambda)$で表せる.
        \[\mathbb{H}(e^{\lambda X}) = \lambda \varphi_X'(\lambda) - \varphi_X(\lambda)\log\varphi_X(\lambda). \tag{3.3}\label{3.3}\]
    \end{itemize}
\end{frame}

\begin{frame}
\begin{exampleblock}{Example 3.1 (Entropy of a Gauusian random variable)}
    \begin{itemize}
        \item $X$は1次元正規分布$X\sim \mathcal{N}(0, \sigma^2)$とすると, $\varphi_X(\lambda) = e^{\lambda^2\sigma^2/2}, \varphi_X'(\lambda) = \lambda \sigma^2\varphi_X(\lambda)$なので,
        \[ \mathbb{H}(e^{\lambda X}) = \lambda^2\sigma^2\varphi_X(\lambda) - \frac{1}{2}\lambda^2\sigma^2\varphi_X(\lambda) = \frac{1}{2}\lambda^2\sigma^2\varphi_X(\lambda). \tag{3.4}\label{3.4}\]
    \end{itemize}
\end{exampleblock}
　\\
\begin{itemize}
    \item この節の残りで, このエントロピー(\ref{3.3})とtail boundsとの関連性を説明していく.
\end{itemize}
\end{frame}

\subsection{3.1.2 Herbst argument and its extensions}
\begin{frame}{3.1.2 Herbst argument and its extensions}
\begin{itemize}
    \item ある定数$\sigma > 0$が存在して, エントロピーが次の上限を満たすとする.
    \[ \mathbb{H}(e^{\lambda X}) \le \frac{1}{2}\sigma^2 \lambda^2\varphi_X(\lambda).\tag{3.5}\label{3.5} \]
    \begin{itemize}
        \item Example 3.1より, 正規分布$X\sim \mathcal{N}(0,\sigma^2)$は任意の$\lambda \in \mathbb{R}$に対し(3.5)をイコールで満たす.
        \item また任意のboundedな確率変数も(\ref{3.5})を満たす(Exercise 3.7).
    \end{itemize}
    \item このとき, その確率変数はsub-Gaussianとなる.
\end{itemize}
\begin{block}{Proposition 3.2 (Herbst argument)}
    エントロピー$\mathbb{H}(e^{\lambda X})$が(\ref{3.5})を任意の$\lambda \in I$ (ただし$I=[0, \infty)\ \mathrm{or}\ \mathbb{R}$)について満たすとする.
    このとき,
    \[ \log \ex[e^{\lambda(X-\ex[X])}] \le \frac{1}{2}\lambda^2\sigma^2 \ \ \ \mathrm{for\ all}\ \lambda\in I. \tag{3.6}\label{3.6} \]
\end{block}
\end{frame}

\begin{frame}{}
Remarks:
\begin{itemize}
    \item $I = \mathbb{R}$なら, (\ref{3.6})は$X-\ex[X]$がパラメータ$\sigma$のsub-Gauusianであることと同値.
    \item Chernoff argumentより, $I = [0, \infty)$で片側tail-bound
    \[ \mathbb{P}[X \ge \ex[X]+t] \le e^{-\frac{t^2}{2\sigma^2}} \tag{3.7}\label{3.7}\]
    が得られ, $I=\mathbb{R}$なら両側tail bounds
    \[ \mathbb{P}[|X-\ex[X]|\ge t] \le 2e^{-\frac{t^2}{2\sigma^2}}\]
    となる.
\end{itemize}
\end{frame}

\begin{frame}{}{} 
{\bf Proof.}
\begin{itemize}
    \item $I = [0,\infty)$の場合のみ示す($I=\mathbb{R}$は演習とする).
    \item エントロピーのモーメント母関数による表現(\ref{3.3})と仮定(\ref{3.5})より,
    \[\mathbb{H}(e^{\lambda X}) = \lambda \varphi'(\lambda) - \varphi(\lambda)\log\varphi(\lambda)\le\frac{1}{2}\sigma^2\lambda^2\varphi(\lambda) \ \ \ \forall \lambda \ge 0.\tag{3.8}\label{3.8} \]
    \item 関数$G$を$G(\lambda):= \frac{1}{\lambda}\log\varphi(\lambda)\ (\lambda\ne 0)$と定義し, $\lambda=0$では連続性を満たすように
    \[ G(0):= \lim_{\lambda \to 0}G(\lambda) = \ex[X] \tag{3.9}\label{3.9}\]
    とする.
    \item $G'(\lambda) = \frac{1}{\lambda}\frac{\varphi'(\lambda)}{\varphi(\lambda)}-\frac{1}{\lambda^2}\log\varphi(\lambda)$より, (\ref{3.8})は$G'(\lambda) \le \frac{1}{2}\sigma^2$となるので, $\lambda_0(>0)$から$\lambda$まで両辺積分すると
    \[ G(\lambda) - G(\lambda_0) \le \frac{1}{2}\sigma^2(\lambda-\lambda_0). \]
    \item $\lambda_0 \downarrow 0$とすると
    \[ G(\lambda) - \ex[X] \le \frac{1}{2}\sigma^2\lambda \]
    となり, これは(\ref{3.6})と同値である.\qed
\end{itemize}
\end{frame}

\begin{frame}{}
\begin{itemize}
    \item 2章と同様に, 次はsub-exponential tailをもつ確率変数を考える.
\end{itemize}
\begin{block}{Proposition 3.3 (Bernsten entropy bound)}
    正整数$b, \sigma$が存在して, エントロピー$\mathbb{H}(e^{\lambda X})$は以下を満たすとする.
    \[
        \mathbb{H}(e^{\lambda x})
        \le \lambda^2\left\{b\varphi_X'(\lambda) + \varphi_X(\lambda)(\sigma^2-b\ex[X])\right\}
        \ \ \ \mathrm{for\ all}\ \lambda \in [0, 1/b).
        \tag{3.10}\label{3.10}
    \]
    このとき, 
    \[
        \log\ex[e^{\lambda(X-\ex[X])}] \le \sigma^2\lambda^2(1-b\lambda)^{-1}
        \ \ \ \mathrm{for\ all}\ \lambda \in [0, 1/b).
        \tag{3.11}\label{3.11}
    \]
\end{block}
Remarks:
\begin{itemize}
    \item Chernoff argumentより, Prop.3.3は以下のsub-exponential tailsをもつ変数の上側Bernstein-type boundを含意する.
    \[
        \mathbb{P}[X\ge\ex[X] + \delta]
        \le \exp\left(-\frac{\delta^2}{4\sigma^2+2b\delta}\right)
        \ \ \ \mathrm{for\ all}\ \delta \ge 0.
        \tag{3.12}\label{3.12}
    \]
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Proof.}
\begin{itemize}
    \item 一般性を失わずに$\ex[X] = 0$と$b = 1$を仮定できる(see Exercise 3.6).
    \item このとき(\ref{3.10})は次のように簡単化される.
    \[
        \mathbb{H}(e^{\lambda X})
        \le \lambda^2 \left\{\varphi'(\lambda) + \varphi(\lambda)\sigma^2\right\}
        \ \ \ \mathrm{for\ all}\ \lambda \in [0,1).
        \tag{3.13}\label{3.13}
    \]
    \item Prop.3.2の証明と同様に$G(\lambda) = \frac{1}{\lambda}\log \varphi(\lambda)$を定義すると,
    (\ref{3.13})は$G' \le \sigma^2 + \frac{\varphi'}{\varphi}$と同値になる.
    \item $\lambda_0 > 0$を任意にとり$\lambda_0$から$\lambda$まで両辺積分すると,
    \[
        G(\lambda) - G(\lambda_0)
        \le \sigma^2(\lambda-\lambda_0) + \log\varphi(\lambda) - \log \varphi(\lambda_0).
    \]
    \item $\lambda_0 \downarrow 0$とすると,
    $\lim_{\lambda\downarrow 0}G(\lambda_0) = \ex[X]$と$\log\varphi(0)=0$より,
    \[
        G(\lambda) - \ex[X] \le \sigma^2 \lambda + \log\varphi(\lambda)
        \tag{3.14}\label{3.14}
    \]
    となる.
    \item (\ref{3.14})に$G$と$\varphi$を入れて書き換えると(\ref{3.11})が得られる.\qed
\end{itemize}
\end{frame}

\subsection{3.1.3 Separately convex functions and the entropic method}
\begin{frame}{3.1.3 Separately convex functions and the entropic method}
\begin{itemize}
    \item Entropy methodは複数の確率変数からなる関数のconcentrationを考える時に強力.
    \item 関数$f:\mathbb{R}^n \to \mathbb{R}$が{separately convex}であるとは,
          各$k\in\{1,\dots,n\}$について1変数関数
          \[y_k \mapsto f(x_1,\dots,x_{k-1},y_k,x_{k+1},\dots,x_n)\]
          が任意の$(x_1,\dots,x_{k-1},x_{k+1},\dots,x_n) \in \mathbb{R}^{n-1}$に対して凸であることをいう.
    \item また関数$f$がユークリッドノルムに対して$L$-Lipschitzであるとは,
          \[
              \left|f(x)-f(x')\right| \le L \|x-x'\|
              \ \ \ \mathrm{for\ all}\ x,x'\in\mathbb{R}^n.
          \]
          が成り立つことをいう.
\end{itemize}
\end{frame}

\begin{frame}
\begin{block}{Theorem 3.4}
    $\{X_i\}_{i=1}^n$は独立な確率変数列でそれぞれのサポートは$[a,b]$に含まれるものとし,
    $f:\mathbb{R}^n\to\mathbb{R}$はseparately convexかつ$L$-Lipschitzであるとする.
    このとき, 任意の$\delta > 0$に対して
    \[
        \mathbb{P}\left[ f(X) \le \ex[f(X)] + \delta \right]
        \le \exp\left(-\frac{\delta^2}{4L^2(b-a)^2}\right)
        \tag{3.16}\label{3.16}
    \]
    が成り立つ.
\end{block}
{Remarks:}
\begin{itemize}
    \item この結果はGaussianヘ変数のLipscitz関数のupper tail boundを求めたThm.2.26のanalogueだが,
          独立かつboundedな変数に対して適用できる.
    \item ただし, separetely convexityの仮定は一般に取り除くことができない.
    \item $f$がjointly convexの場合はlower tail boundの導出に他のテクニックが使える(cf Thm.3.24).
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.5} (Sharp bounds on Rademacher complexity)
    \begin{itemize}
        \item 有界部分集合$\mathcal{A}\in\mathbb{R}^n$は所与とし,
        確率変数$Z = \sup_{a\in\mathcal{A}}\sum_{k=1}^na_k\epsilon_k$を考える.
        \item $\epsilon_k \in \{\-1,1\}$はi.i.d.なRademacher variables.
        \item $Z$は線形関数の$\sup$をとったものなのでjointly (したがってseparately) convex.
        \item 別の$Z' = Z(\epsilon')$に対し, 任意の$a\in\mathcal{A}$について
        \[
            \langle a,\epsilon\rangle - Z'
            = \langle a,\epsilon\rangle - \sup_{a'\in\mathcal{A}}\langle a,\epsilon'\rangle
            \le \langle a, \epsilon-\epsilon'\rangle
            \le \|a\|_2 \|\epsilon-\epsilon'\|_2.
        \]
        \item $a\in \mathcal{A}$について$\sup$をとると
        $Z-Z' \le \sup_{a\in\mathcal{A}}\|a\|_2\|\epsilon-\epsilon'\|$.
        \item よって, $Z$は$\mathcal{W}(\mathcal{A}):=\sup_{a\in\mathcal{A}}\|a\|_2\|$-Lipschitz.
        \item したがって, Theorem 3.4より
        \[ \mathcal{P}[Z \le \ex[Z]+t] \le \exp\left(-\frac{t^2}{16\mathcal{W}^2(\mathcal{A})}\right).
        \tag{3.17}\label{3.17}\]
        \item 通常$\mathcal{W}^2(A)$は$\sum_{k=1}^n\sup a_k^2$よりずっと小さいので, Example2.25より強いboundとなる.
        \endexample
    \end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.6} (Operator norm of a random matrix)
\begin{itemize}
    \item $\mathbf{X} \in \mathbb{R}^{n^\times d}$はランダム行列で,
    $X_{ij}$は平均$0$, サポート$[-1,+1]$の分布からi.i.d.でひかれるとする.
    \item $|||\mathbf{X}|||_2$はスペクトルノルム（最大の特異値）, or $\ell_2$-オペレータノルムとし, これは以下で与えられる.
    \[
        |||\mathbf{X}|||_{2}
        =\max _{v \in \mathbb{R}^{d} \atop \|v\|_{2}=1}\|\mathbf{X} v\|_{2}
        =\max _{v \in \mathbb{R}^{d}\atop \|v\|_{2}=1} \max _{u \in \mathbb{R}^{n} \atop\|u\|_{2}=1} u^{\mathrm{T}} \mathbf{X} v .
        \tag{3.18}\label{3.18}
    \]
    \item $\mathbf{X} \mapsto |||\mathbf{X}|||_2$を関数$f:\mathbb{R}^{nd}\to\mathbb{R}$と見ると,
    $f$はTheorem 3.4の仮定を満たす.
    \begin{itemize}
        \item $f$は線形な関数のsupremumなのでconvex,
        \item かつ
        \[
            \Big| |||\mathbf{X}|||_{2}-|||\mathbf{X}^{\prime}|||_{2}\Big|
            \stackrel{(\mathrm{i})}{\leq}|||\mathbf{X}-\mathbf{X}^{\prime}|||_{2}
            \stackrel{(\mathrm{ii})}{\leq}|||\mathbf{X}-\mathbf{X}^{\prime}|||_{\mathrm{F}},
            \tag{3.19}\label{3.19}
        \]
        となる（$(\mathrm{i})$は三角不等式, $(\mathrm{ii})$はフロべニウスノルムは常にオペレータノルムを上からおさえることより）ので,
        $f$は$L=1$でLipschitz.
    \end{itemize}
    \item したがって, Theorem 3.4より,
    \[
        \mathbb{P}[|||\mathbf{X}|||_2\ge \ex[|||\mathbf{X}|||_2]+\delta]
        \le e^{-\frac{\delta^2}{16}}.
    \]
\end{itemize}
\end{frame}

\subsection{3.1.4 Tensorization and separately convex functions}
\begin{frame}{3.1.4 Tensorization and separately convex functions}
\begin{itemize}
    \item 2つのlemmaをもとにTheorem 3.4を証明する.
\end{itemize}
\begin{block}{Lemma 3.7}
    $X, Y \sim \mathbb{P}$, i.i.d.とすると, 任意の関数$g:\mathbb{R}\to\mathbb{R}$に対し以下が成り立つ.
    \[
        \mathbb{H}(e^{\lambda g(X)})
        \le \lambda^2\ex\left[(g(X)-g(Y))^2e^{\lambda g(X)}\mathbb{I}[g(X)\ge g(Y)]\right]
        \ \ \ \mathrm{for\ all}\ \lambda > 0.
        \tag{3.20a}\label{3.20a}
    \]
    さらに$X$のサポートが$[a,b]$に含まれ, $g$が凸かつLipschitzなら,
    \[
        \mathbb{H}(e^{\lambda g(X)})
        \le \lambda^2(b-a)^2\ex\left[(g'(X))^2e^{\lambda g(X)}\right]
        \ \ \ \mathrm{for\ all}\ \lambda>0,
        \tag{3.20b}\label{3.20b}
    \]
    が成り立つ($g'$は$g$の導関数).
\end{block}
\end{frame}

\begin{frame}{}
\begin{itemize}
    \item Lemma 3.7は, 凸かつLipschitzな関数はほとんどいたるところ微分可能であるという事実を使っている(Rademacher's Theorem).
    \item また, $g$が$L$-Lipschitzなら$\|g'\|_\infty \le L$\footnote{関数$f$に対して$\|f\|_\infty$は$f$の本質的上限$\|f\|_\infty:=\inf\{C\ge 0: |f(x)| \le C \mathrm{\ almost\ every}\ x.\}$.}なので,
          (\ref{3.20b})は以下を含意する.
          \[
              \mathbb{H}(e^{\lambda  g(X)}) \le \lambda^2 L^2(b-a)^2\ex[e^{\lambda g(X)}]
              \ \ \ \mathrm{for\ all}\ \lambda > 0.
          \] 
    \item したがってProposition 3.2より
    \[ \mathbb{P}[g(X) \ge \ex[g(X)]+\delta] \le e^{-\frac{\delta^2}{4L^2(b-a)^2}} \]
    となるので, Lemma 3.7はTheorem 3.4の1変数バージョンをただちに導く.
    \item しかし(\ref{3.20b})では$L$でなく$g'$とより強いboundとなっており,
    これがTheorem 3.4の導出において重要となる.
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Proof of Lemma 3.7}
\begin{itemize}
    \item エントロピーの定義より,
\begin{align*}
    \mathbb{H}(e^{\lambda g(X)})
    &= \ex_X[\lambda g(X) e^{\lambda g(X)}] - \ex_X[e^{\lambda g(X)}]\log(\ex_Y[e^{\lambda g(Y)}])\\
    &\le \ex_X[\lambda g(X) e^{\lambda g(X)}] - \ex_{X,Y}[e^{\lambda g(X)}\lambda g(Y)] \tag{Jensen's inequality}\\
    &= \frac{1}{2} \ex_{X,Y}\left[\lambda\{g(X)-g(Y)\}\{e^{\lambda g(X)}-e^{\lambda g(Y)}\}\right] \\
    &= \lambda \ex\left[\{g(X)-g(Y)\}\{e^{\lambda g(X)}-e^{\lambda g(Y)}\}\mathbb{I}[g(X) \ge g(Y)]\right]. \tag{3.22}\label{3.22}
\end{align*}
    となる(ただし最後の等式は$X,Y$の対称性より).
\end{itemize}
\end{frame}

\begin{frame}{}
\begin{itemize}
    \item 指数関数の凸性より, 任意の$s\ge t$に対し$e^s - e^t \le e^s(s-t)$なので,
    \[ (s-t)(e^s-e^t)\mathbb{I}[s\ge t] \le (s-t)^2e^s\mathbb{I}[s\ge t] \]
    \item これを(\ref{3.22})に適用すると, (\ref{3.20a})
    \[
        \mathbb{H}(e^{\lambda g(X)})
        \le \lambda^2\ex[(g(X)-g(Y))^2 e^{\lambda g(X)} \mathbb{I}[g(X)\ge g(Y)]].
        \tag{3.23}\label{3.23}
    \]
    が得られる.
    \item さらに$g$が凸で$x,y\in[a,b]$とすると, $g(x)-g(y)\le g'(x)(x-y)$より,
    \[(g(x)-g(y))^2\mathbb{I}[g(x)\ge g(y)] \le (g'(x))^2(x-y)^2\le (g'(x))^2(b-a)^2\]
    となるので, これを(\ref{3.23})に適用すれば(\ref{3.20a})が得られる.\qed
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Tensorization peoperty of entropy}
\begin{itemize}
    \item 関数$f:\mathbb{R}^n\to\mathbb{R}, k \in \{1,\dots,n\}, x_{\setminus k}=(x_i, i\ne k)\in\mathbb{R}^{n-1}$に対して,
    条件付きエントロピーを
    \[ \mathbb{H}(e^{\lambda f_k(X_k)} \mid x_{\setminus k}) := \mathbb{H}(e^{\lambda f(x_1,\dots,x_{k-1},X_k,x_{k+1},\dots,x_n)}) \]
    と定義する（$f_k$は$x_k\mapsto f(x_1,\dots,x_k,\dots,x_n)$なる1変数関数）.
    \item 確率変数$X^{\setminus k}\in \mathbb{R}^{n-1}$に対し,
    このエントロピー$\mathbb{H}(e^{\lambda f_k(X_k)} \mid X^{\setminus k})$は確率変数となる.
\end{itemize}
\begin{block}{Lemma 3.8 (Tensorization of entropy)}
$n$変数関数$f:\mathbb{R}^n \to \mathbb{R}$と, 独立な確率変数列$\{X_k\}_{k=1}^n$に対し,
\[
    \mathbb{H}(e^{\lambda f(X_1\dots,X_k)})
    \le \ex\left[ \sum_{k=1}^n\mathbb{H}(e^{\lambda f_k(X_k)} \mid X^{\setminus k}) \right]
    \ \ \ \mathrm{for\ all}\ \lambda > 0.
    \tag{3.21}\label{3.21}
\]
\end{block}
\end{frame}

\begin{frame}{}{}
{\bf Proof of Lemma 3.8}
\begin{itemize}
    \item まずエントロピーは以下のように表せる（Exercise 3.9）.
    \[
        \mathbb{H}\left(e^{\lambda f(X)}\right)
        = \sup _{g}\left\{\mathbb{E}\left[g(X) e^{\lambda f(X)}\right] \mid \mathbb{E}\left[e^{g(X)}\right] \leq 1\right\}.
        \tag{3.24}\label{3.24}
        \]
    \item 各$j = 1,\dots,n$に対し, $X_j = (X_j\dots,X_n)$とする.
    \item $g$は$\ex[e^{g(X)}]\le 1$を満たす関数とする.
    \item 関数列$g_1,\dots, g_n$を以下で定義する.
    \begin{align*}
        &g^{1}\left(X_{1}, \ldots, X_{n}\right):=g(X)-\log \mathbb{E}\left[e^{g(X)} \mid X_{2}^{n}\right] \\
        &g^{k}\left(X_{k}, \ldots, X_{n}\right):=\log \frac{\mathbb{E}\left[e^{g(X)} \mid X_{k}^{n}\right]}{\mathbb{E}\left[e^{g(X)} \mid X_{k+1}^{n}\right]} \quad \mathrm{for}\ k=2, \ldots, n.
    \end{align*}
    \item すると定義より,
    \[
        \sum_{k=1}^{n} g^{k}\left(X_{k}, \ldots, X_{n}\right)=g(X)-\log \mathbb{E}\left[e^{g(X)}\right] \geq g(X).
        \tag{3.25}\label{3.25}
    \]
    で, さらに$\ex[\exp(g^k(X_k,\dots,X_n))\mid X_{k+1}^n] = 1$.
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item このとき,
    \begin{align*}
        \mathbb{E}\left[g(X) e^{\lambda f(X)}\right] 
        & \stackrel{(\mathrm{i})}{\le} \sum_{k=1}^{n} \mathbb{E}\left[g^{k}\left(X_{k}, \ldots, X_{n}\right) e^{\lambda f(X)}\right] \\
        &=\sum_{k=1}^{n} \mathbb{E}_{X_{\setminus k}}\left[\mathbb{E}_{X_{k}}\left[g^{k}\left(X_{k}, \ldots, X_{n}\right) e^{\lambda f(X)} \mid X_{\backslash k}\right]\right] \\
        & \stackrel{(\mathrm{ii})}{\leq} \sum_{k=1}^{n} \mathbb{E}_{X_{\setminus k}}\left[\mathbb{H}\left(e^{\lambda f_{k}\left(X_{k}\right)} \mid X_{\backslash k}\right)\right]
    \end{align*}
    となる, ただし$(\mathrm{i})$は(\ref{3.25}), $(\mathrm{ii})$は(\ref{3.24})と$\ex[\exp(g^k(X_k,\dots,X_n))\mid X_{\backslash k}] = 1$より.
    \item これを関数$g \mathrm{\ s.t.\ } \ex[e^{g(X)}]\le 1$に対して$\sup$をとると, (\ref{3.24})より
    \[ \mathbb{H}(e^{\lambda f(X_1\dots,X_k)})
    \le \ex\left[ \sum_{k=1}^n \mathbb{H}(e^{\lambda f_k(X_k)} \mid X^{\setminus k}) \right] \]
    が得られる.\qed
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Proof of Theorem 3.4}
\begin{itemize}
    \item 各$k=1,\dots,n$と$x_{\backslash k}\in\mathbb{R}^{n-1}$について, 仮定より$f_k$は凸かつLipschitzなので,
    Lemma 3.7より 
    \begin{align*}
        \mathbb{H}\left(e^{\lambda f_{k}\left(X_{k}\right)} \mid x_{\backslash k}\right)
        &\leq \lambda^{2}(b-a)^{2} \mathbb{E}_{X_{k}}\left[\left(f_{k}^{\prime}\left(X_{k}\right)\right)^{2} e^{\lambda f_{k}\left(X_{k}\right)} \mid x_{\backslash k}\right] \\
        &=\lambda^{2}(b-a)^{2} \mathbb{E}_{X_{k}}\left[\left(\frac{\partial f\left(x_{1}, \ldots, X_{k}, \ldots, x_{n}\right)}{\partial x_{k}}\right)^{2} e^{\lambda f\left(x_{1}, \ldots, X_{k}, \ldots, x_{n}\right)}\right]
    \end{align*}
    \item Lemma 3.8より,
    \[
        \mathbb{H}\left(e^{\lambda f(X)}\right)
        \leq \lambda^{2}(b-a)^{2} \mathbb{E}\left[\sum_{k=1}^{n}\left(\frac{\partial f(X)}{\partial x_{k}}\right)^{2} e^{\lambda f(X)}\right]
        \stackrel{(\mathrm{i})}{\leq}  \lambda^{2}(b-a)^{2} L^{2} \mathbb{E}\left[e^{\lambda f(X)}\right]
    \]
    となる, ただし$\mathrm{(i)}$はLipschitz関数の性質
    $\|\nabla f(x)\|_{2}^{2}=\sum_{k=1}^{n}\left(\frac{\partial f(x)}{\partial x_{k}}\right)^{2} \leq L^{2}$
    より.
    \item したがって, Proposition 3.2を$f(X)$に適用すると, upper bound (\ref{3.16})が得られる.\qed
\end{itemize}
\end{frame}

\section{3.2 A geometric perspective on concentration}

\begin{frame}{3.2 A geometric perspective on concentration}
\begin{itemize}
    \item Concentration of measureの幾何的な面の議論に移る.
    \item この章の結果は, 距離測度空間(metric measure space)---つまり, 距離空間$(\mathcal{X}, \rho)$とそのボレル集合上の確率測度$\mathbb{P}$---の言葉で示される.
    \item 距離空間の例としては, 
    \begin{itemize}
        \item the Euclid space $\mathcal{X} = \mathbb{R}^n$ with the usual Euclidian metric $\rho(x,y):=\|x-y\|_2$,
        \item the discrete cube $\mathcal{X} = \{0, 1\}^n$ with the Hamming metric $\rho(x,y)=\sum_{j=1}^n\mathbb{I}[x_j\ne y_j]$
    \end{itemize}
    などがある.
\end{itemize}
\end{frame}

\subsection{3.2.1 Concentration functions}
\begin{frame}{3.2.1 Concentration functions}
\begin{itemize}
    \item 集合$A\subseteq \mathcal{X}$と点$x\in \mathcal{X}$に対し, それらの距離を以下とする.
    \[ \rho(x, A) := \inf_{y \in A}\rho(x, y). \tag{3.26}\label{3.26}\]
    \item パラメータ$\epsilon > 0$に対し, $A$の$\epsilon$-拡張($\epsilon$-enlargement)は以下で与えられる.
    \[ A^\epsilon := \{ x \in \mathcal{X} \mid \rho(x, A) < \epsilon \}. \tag{3.27}\label{3.27} \]
\end{itemize}
\begin{block}{Definition 3.9}
    距離測度空間$(\mathcal{X}, \rho, \mathbb{P})$のconcentration function $\alpha:[0,\infty)\to\mathbb{R}_+$は,
    \[
        \alpha_{\mathbb{P}, (\mathcal{X}, \rho)}(\epsilon)
        := \sup_{A \subseteq \mathcal{X}}\left\{ 1-\mathbb{P}[A^\epsilon]\ \Big|\ \mathbb{P}[A] \ge \frac{1}{2} \right\}
        \tag{3.28}\label{3.28}
    \]
    で定義される, ただし$\sup$は全ての可測部分集合$A$についてとられる.
\end{block}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.10} (Concentration function for sphere)
\begin{itemize}
    \item $n$次元Euclidean sphere
    \[
        \mathbb{S}^{n-1} := \{x\in \mathbb{R}^n\mid \|x\|_2=1\}
        \tag{3.29}\label{3.29}
    \]
    上の一様分布$\mathbb{P}$と,
    geodesic distance $\rho(x, y):=\arccos\langle x,y\rangle$を考える.
    \item 各$y\in\mathbb{S}^{n-1}$に対し, hemisphere $H_y$ $(\mathbb{P}(H_y)=1/2)$を以下で定義する. (a)
    \[
        H_y
        := \{x\in \mathbb{S}^{n-1}\mid \rho(x,y) \ge \pi/2\}
        = \{ x \in \mathbb{S}^{n-1} \mid \langle x, y\rangle \le 0 \}.
        \tag{3.30}\label{3.30}
    \]
    \item この$\epsilon$-拡張は, 以下となる. (b)
    \[
        H_y^\epsilon = \{z\in \mathbb{S}^{n-1} \mid \langle z, y \rangle < \sin(\epsilon)\}.
        \tag{3.31}\label{3.31}
    \]
\end{itemize}
\begin{center}
    \includegraphics[width=8cm]{figure_3_1.png}
\end{center}
\end{frame}

\begin{frame}{}{}
\begin{itemize}
    \item 一様分布であることより, concentration functionは, 
    \[
        \alpha_{\mathbb{S}^{n-1}}(\epsilon) = 1 - \mathbb{P}[H_y^\epsilon].
        \tag{3.32}\label{3.32}
    \]
    \item $\sin(\epsilon) \ge \epsilon/2$ (for all $\epsilon\in (0,\pi/2]$)より,
    $\mathbb{P}[H_y^\epsilon] \ge \mathbb{P}[\tilde{H}_y^\epsilon]$である, ただし
    \[
        \tilde{H}_y^\epsilon
        := \{z\in \mathbb{S}^{n-1} \mid \langle z, y\rangle \le \epsilon/2\}.
    \]
    \item さらに, 幾何的な計算により, 任意の$\epsilon \in (0, \sqrt{2})$に対して
    \[
        \mathbb{P}[\tilde{H}_y^\epsilon]
        \ge 1 - \left(1-\left(\frac{\epsilon}{2}\right)^2\right)^{n/2}
        \ge 1 - e^{-n\epsilon^2/8}
        \tag{3.33}\label{3.33}
    \]
    となる(？), ただし最後の不等号は$(1-t)\le e^{-t}$より.
    \item したがってconcentration functionの上限$\alpha_{\mathbb{S}^{n-1}}(\epsilon) \le e^{-n\epsilon^2/8}$が得られる.
    \item 似たアプローチでさらに注意深く上限をとると, より厳しい上限
    \[
        \alpha_{\mathbb{S}^{n-1}}(\epsilon) \le \sqrt{\frac{\pi}{2}}e^{-\frac{n\epsilon^2}{2}}
        \tag{3.34}\label{3.34}
    \]
    が得られる（？）
\end{itemize}
\end{frame}

\subsection{3.2.2 Connection to Lipschitz functions}
\begin{frame}{3.2.2 Connection to Lipschitz functions}
\begin{itemize}
    \item 関数$f:\mathcal{X}\to\mathbb{R}$が距離$\rho$に関して$L$-Lipschitzであるとは, 以下が成り立つことをいう.
    \[ |f(x)-f(y)| \le L \rho(x, y) \ \ \ \mathrm{for\ all}\ x,y\in\mathcal{X}. \tag{3.36}\label{3.36}\]
    \item 確率変数$X \sim \mathbb{P}$に対し, $m_f$は$f(X)$の任意のメディアンとする, つまり,
    \[ \mathbb{P}[f(X) \ge m_f] \ge 1/2\ \ \ \mathrm{and}\ \ \ \mathbb{P}[f(X) \le m_f] \ge 1/2. \tag{3.37}\label{3.37}\]
\end{itemize}
\begin{block}{Proposition 3.11}
\begin{itemize}
    \item 確率変数$X\sim \mathbb{P}$とconcentration function$\alpha_{\mathbb{P}}$に対し,
    $(\mathcal{X}, \rho)$上の$L$-Lipschitz関数$f$は次を満たす.
    \[ \mathbb{P}[|f(X)-m_f|\ge \epsilon] \le 2 \alpha_{\mathbb{P}}(\epsilon/L). \tag{3.39a}\label{3.39a}\]
    \item 関数$\beta:\mathbb{R}_+\to\mathbb{R}_+$は, 任意の$1$-Lipschitz関数$f$に対し
    \[ \mathbb{P}[f(X) \ge \ex[f(X)] + \epsilon] \le \beta(\epsilon)\ \ \ \mathrm{for\ any}\ \epsilon \ge 0. \tag{3.39b}\label{3.39b}\]
    を満たすとする. このとき, concentraion functionはbound $\alpha_{\mathbb{P}}(\epsilon) \le \beta(\frac{\epsilon}{2})$をもつ.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}{}{}
{\bf Proof of Proposition 3.11}\\
{（前半）}
\begin{itemize}
    \item 集合$A = \{x\in\mathcal{X} \mid f(x) \le m_f\}$と, その$\epsilon/L$-拡張$A^{\epsilon/L}$について考える.
    \item 任意の$x \in A^{\epsilon/L}$に対し, $\rho(x, y) < \epsilon/L$なる$y\in A$が存在する.
    \item Lipschitz性より$|f(x) - f(y)| \le L\rho(x,y) < \epsilon$なので,
    \[ A^{\epsilon/L} \subseteq \{x\in\mathcal{X} \mid f(x) < m_f + \epsilon\}. \tag{3.38}\label{3.38} \]
    \item したがって,
    \[ 
        \mathbb{P}[f(X)\ge m_f+\epsilon]
        \stackrel{\mathrm{(i)}}{\le} 1-\mathbb{P}[A^{\epsilon/L}]
        \stackrel{\mathrm{(ii)}}{\le} \alpha_{\mathbb{P}}(\epsilon/L)
    \]
     が成り立つ, ただし$\mathrm{(i)}$は(\ref{3.38}), $\mathrm{(ii)}$は$\mathbb{P}(A) \ge 1/2$と$\alpha_{\mathbb{P}}$の定義より.
    \item 同様にして$\mathbb{P}[f(X)\le m_f-\epsilon] \le \alpha_{\mathbb{P}}(\epsilon/L)$も示されるので, (\ref{3.39a})が得られる.
\end{itemize}
\end{frame}

\begin{frame}{}{}
{（後半）}
\begin{itemize}
    \item $\epsilon \ge 0$を固定し, $A$は$\mathbb{P}[A]\ge 1/2$を満たす任意の可測集合とする.
    \item 関数$f(x) := \min\{\rho(x, A), \epsilon\}$は1-Lipschitz（らしい）で$1-\mathbb{P}[A^\epsilon]=\mathbb{P}[f(X)\ge\epsilon]$.
    \item また, 定義より$\ex[f(X)] \le (1-\mathbb{P}[A])\epsilon \le \epsilon/2$なので, 
    \[ \mathbb{P}\left[f(X)\ge \epsilon\right] \le \mathbb{P}\left[f(X)\ge\ex[f(X)]+\epsilon/2\right] \le \beta(\epsilon/2). \]
    \item したがって, 任意の可測集合$A \mathrm{\ s.t.\ }\mathbb{P}[A]\ge 1/2$に対して
    \[ 1-\mathbb{P}[A^\epsilon] \le \beta(\epsilon/2) \]
    となるので, $\alpha_{\mathbb{P}}(\epsilon) \le \beta({\epsilon/2})$.\qed
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.12} (L\'evy concentration on $\mathbb{S}^{n-1}$)
\begin{itemize}
    \item Example 3.10の$(\mathbb{S}^{n-1}, \rho, \mathbb{P})$において, concentration functionの上限は以下で得られた.
    \[
        \alpha_{\mathbb{S}^{n-1}}(\epsilon) \le \sqrt{\frac{\pi}{2}}e^{-\frac{n\epsilon^2}{2}}.
    \]
    \item したがって, 任意の$1$-Lipschitz関数$f:\mathbb{S}^{n-1}\to\mathbb{R}$に対して,
    \[
        \mathbb{P}[|f(X)-m_f| \ge \epsilon] \le \sqrt{2\pi}e^{-\frac{n\epsilon^2}{2}}
    \tag{3.40}\label{3.40}
    \]
    となる.
    \item さらに, Exercise 2.14(d)より, 以下も成り立つ.
    \[
        \mathbb{P}[|f(X) - \ex[f(X)]| \ge \epsilon] \le 2\sqrt{2\pi}e^{-\frac{n\epsilon^2}{8}}.
        \tag{3.41}\label{3.41}
    \]
    \endexample
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.13} (Concentration for Boolean hypercube)
\begin{itemize}
    \item Boolean hypercube $\mathcal{X} = \{0, 1\}^n$とHamming metric $\rho_H(x, y):= \sum_{j=1}^n\mathbb{I}[x_j\ne y_j]$を考える.
    \item 確率測度$\mathbb{P}$は$\mathcal{X}$上の一様分布.
    \item 半径$r$, 中心$x\in\mathcal{X}$の球をHamming ballと呼び, 以下で定義する.
    \[ \mathbb{B}_H(r; x) = \{y \in \{0,1\}^n \mid \rho_H(y,x)\le r\}. \]
    \item 非空な部分集合$A, B \subseteq \mathcal{X}$に対し, Harper's combinatorial theoremより,
    正整数$r_A, r_B$と対応する部分集合$A', B' \subseteq \mathcal{X}$が存在し, 以下を満たす.
    \begin{itemize}
        \item $\mathbb{B}_{H}\left(r_{A}-1 ; 0\right) \subseteq A^{\prime} \subseteq \mathbb{B}_{H}\left(r_{A} ; 0\right) \quad
            \mathrm{and} \quad \mathbb{B}_{H}\left(r_{B}-1 ; 1\right) \subseteq B^{\prime} \subseteq \mathbb{B}_{H}\left(r_{B} ; 1\right).$\footnote{$0,1$はそれぞれall-zeros vector, all-ones vector.}
        \item $\mathrm{card}(A) = \mathrm{card}(A'), \mathrm{card}(B)=\mathrm{card}(B')$.
        \item $\rho_H(A', B') \ge \rho_H(A, B)$.
    \end{itemize}
    \item 上の結果より, concentration functionは以下のように抑えられる.
    \[ \alpha_{\mathbb{P}}(\epsilon) \le \exp\left(-\frac{2\epsilon^2}{n}\right) \ \ \ \mathrm{for\ all}\ n\ge 3. \tag{3.42}\label{3.42} \]
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item 任意の部分集合$A$ s.t. $\mathbb{P}[A] = \mathrm{card}(A)/2^n \ge 1/2$をとる.
    \item 任意の$\epsilon > 0$に対し, $B = \mathcal{X}\setminus A^\epsilon$とする.
    \item (\ref{3.42})にを示すには, $\mathbb{P}[B] \le \exp(-2\epsilon^2/n)$を示せば良い.
    \item $\epsilon \le 1$なら$\mathbb{P}[B]\le 1/2\le \exp(-2/n)\le \exp(-2\epsilon^2/n)$なので, 以後$\epsilon > 1$とする.
    \item 定義より,
    \[ \rho_H(A, B) = \min_{a \in A, b\in B}\rho(a,b) \ge \epsilon. \]
    \item $A', B'$をHarperの定理によって保証される集合とする. 
    \item $\mathrm{card}(A)=\mathrm{card}(A')\ge1/2$より, $A'$は$1$の数が$n/2$以下のベクトルを全て含む.
    \item $\rho_H(A', B')\ge \rho_H(A, B) \ge \epsilon$なので, $B'$は1の数が$n/2 + \epsilon$以上であるベクトルを全て含む.
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item したがって, $\{X_i\}_{i=1}^n$をi.i.d. Bernoulli変数とすると, 上の議論とHoeffding boundより,
    \[\mathbb{P}[B]=\mathbb{P}[B']\le\mathbb{P}\left[\sum_{i=1}^nX_i\ge\frac{n}{2}+\epsilon\right] \le \exp\left(-\frac{2\epsilon^2}{n}\right)\]
    となり, $A$は$\mathbb{P}[A]\ge1/2$の任意の集合で$B = \mathcal{X}\setminus A^\epsilon$なので, (\ref{3.42})が得られる.
    \item よってProposition 3.11より, 任意の1-Lipschitz関数に対し
    \[ \mathbb{P}\left[\left|f(X)-m_{f}\right| \geq \epsilon\right] \leq 2 \exp\left(-\frac{2 \epsilon^{2}}{n}\right) .\]
    \endexample
\end{itemize}
\end{frame}

\subsection{3.2.3 From geometry to concentration}
\begin{frame}{3.2.3 From geometry to concentration}
\begin{itemize}
    \item これらの幾何的な面は, 凸幾何学とconcentration of measureの関連性を示唆する.
    \item たとえば, 次のBrunn-Minkowski inequalityを考えてみよう:
    \begin{itemize}
        \item $\mathrm{R}^n$上の任意の2つのcompact set $C, D \subset \mathbb{R}^n$に対し, 以下が成り立つ.
        {\footnotesize\[ \operatorname{vol}(\lambda C+(1-\lambda) D)
        \geq \left(\lambda\operatorname{vol}(C)^{1 / n}+(1-\lambda)\operatorname{vol}(D)^{1 / n}\right)^n
        \ge \operatorname{vol}(C)^\lambda \operatorname{vol}(D)^{1-\lambda}
         \quad \mathrm{for\ all}\ \lambda \in[0,1], \]}
         ただし, $\operatorname{vol}$はvolume, つまり$\mathrm{R}^n$上のLebesgue測度で, 
         \[\lambda C+(1-\lambda)D = \left\{\lambda c + (1-\lambda)d\mid c\in C,\ d\in D\right\}.\]
    \end{itemize}
    \item Concentration functionは$\mathbb{P}[A]\ge 1/2$のもとでの$1-\mathbb{P}[A^\epsilon]$の$\sup$だが,
    $\mathrm{vol}$を(正規化されていない)確率測度とみると, Brunn-Minkowski inequalityはこの上限の導出に使える.
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Example 3.14} (Classical isoperimetric inequality in $\mathbb{R}^n$)
\begin{itemize}
    \item $\mathbb{B}_2^n$を$\mathbb{R}^n$上のEuclidean sphereとする,
    つまり$\mathbb{B}_2^n:=\{x\in\mathbb{R}^n\mid \|x\|_2\le 1\}$.
    \item $A$は$\mathrm{vol}(A) = \mathrm{vol}(\mathbb{B}_2^n)$を満たす任意の集合$A\subset \mathbb{R}^n$とする.
    \item このとき, Brunn-Minkowski inequalityにおいて$\lambda, C, D$を適切に選ぶことで
    \[
        \left[\operatorname{vol}\left(A^{\epsilon}\right)\right]^{1 / n}
        =\left[\operatorname{vol}\left(A+\epsilon \mathbb{B}_{2}^{n}\right)\right]^{1 / n}
        \geq[\operatorname{vol}(A)]^{1 / n}+\left[\operatorname{vol}\left(\epsilon \mathbb{B}_{2}^{n}\right)\right]^{1 / n}
    \]
    となる(see Exercise 3.10).
    \item さらに, $\mathrm{vol}(A) = \mathrm{vol}(\mathbb{B}_2^n)$と$[\mathrm{vol}(\epsilon\mathbb{B}_2^n)]^{1/n} = \epsilon\mathrm{vol}(\mathbb{B}_2^n)^{1/n}$より\footnote{ここテキストでは$[\mathrm{vol}(\epsilon\mathbb{B}_2^n)]^{1/n} = \epsilon\mathrm{vol}(\mathbb{B}_2^n)$となっているがおそらくタイポ.},
    \[ 
        \mathrm{vol}(A^\epsilon)^{1/n}
        \ge (1+\epsilon) \mathrm{vol}(\mathbb{B}_2^n)^{1/n}
        = [\mathrm{vol}((\mathbb{B}_2^n)^\epsilon)]^{1/n}
    \]
    となるので, したがって
    \[
        \mathrm{vol}(A^\epsilon) \ge \mathrm{vol}([\mathbb{B}_2^n]^\epsilon).
        \tag{3.44}\label{3.44}
    \]
    \endexample
\end{itemize}
\end{frame}

\begin{frame}
    \begin{itemize}
        \item Brunn-Minkowski inequalityは, 次のfunctional-analytic generalizationが知られている.
    \end{itemize}
    \begin{block}{Theorem 3.15 (Pr\'ekopa-Leindler inequality)}
        $u,v,w$は非負可積分関数で, ある$\lambda \in [0, 1]$が存在して,
        \[ w(\lambda x + (1-\lambda)y) \ge u(x)^\lambda v(y)^{1-\lambda}
        \quad \mathrm{for\ all}\ x,y\in\mathbb{R}^n.
        \tag{3.46}\label{3.46}\]
        を満たすものとする. このとき,
        \[
            \int w(x)dx \ge \left(\int u(x)\right)^\lambda \left(\int v(x)dx\right)^{1-\lambda}.
            \tag{3.47}\label{3.47}
        \]
    \end{block}
    \begin{itemize}
        \item このPr\'ekopa-Leibler inequalityは,
        strongly log-concaveな分布のもとでのLipschitz関数の集中不等式の導出に使われる.
    \end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item $\mathbb{R}^n$上の分布$\mathbb{P}$ with density $p$が{strongly log-concave distribution}であるとは,
    $\log p$がstrongly concaveであることをいう.\\
    $\Leftrightarrow$ densityが$p(x) = \exp(-\psi(x))$とかける,
    ただし$\psi:\mathbb{R}^n\to\mathbb{R}$はstorongly convex, つまりある$\gamma > 0$が存在して
    \[
        \lambda \psi(x)+(1-\lambda) \psi(y)-\psi(\lambda x+(1-\lambda) y)
        \geq \frac{\gamma}{2} \lambda(1-\lambda)\|x-y\|_{2}^{2}
        \tag{3.48}\label{3.48}
    \]
    を任意の$\lambda \in[0,1],\ x,y\in\mathbb{R}^n$に対して満たす.\\
    　
    \item $n$次元標準Gaussian分布はパラメータ$\gamma=1$のstrongly log-concaveである.
    \item 一般に, covariance matrix $\Sigma\succ 0$
    \footnote{つまり, $\Sigma$が正定値.}のGauusian分布は$\gamma = \gamma_{\min}(\Sigma^{-1})=(\gamma_{\max}(\Sigma))^{-1}$でstrognly log-cocave.
    \item non-Gaussianでもstorongly log-concaveな分布は多数ある（らしい）.
\end{itemize}
\end{frame}

\begin{frame}
\begin{block}{Theorem 3.16}
    $\mathbb{P}$はパラメータ$\gamma>0$のstrongly log-concave distributionとする.
    任意の$L$-Lipschitz関数$f:\mathbb{R}^n\to\mathbb{R}$に対し, 以下が成り立つ.
    \[
        \mathbb{P}[|f(X)-\mathbb{E}[f(X)]|
        \geq t] \leq 2 e^{-\frac{\gamma t^{2}}{4 L^{2}}}.
        \tag{3.49}\label{3.49}
    \]
\end{block}
{\bf Proof.}
\begin{itemize}
    \item $h$を$\ex[h(X)]=0$なる任意の$L$-Lipschitz関数とする.
    \item $\ex[e^{h(X)}]\le e^{L^2/\gamma}$を示せば十分である.
    \begin{itemize}
        \item もしこれが成り立つなら, 任意の$K$-Lipschitz関数$f$と$\lambda\in\mathbb{R}$に対し,
        $L=\lambda K$-Lipschitz関数$h:= \lambda(f - \ex[f(X)])$を考えれば,
        \[ \ex[e^{\lambda(f(X)-\ex[f(X)])}] \le e^{\frac{\lambda^2 K^2}{\gamma}}\quad\mathrm{for\ all}\ \lambda\in\mathbb{R} \]
        となり, $f(X)-\ex[f(X)]$がsub-Gaussianとなるので, (\ref{3.49})のtail boundが得られる.
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item $h$に対し, $g$を以下で定義する.
    \[ g(y) := \inf_{x\in\mathbb{R}^n} \left\{h(x) + \frac{\gamma}{4}\|x-y\|_2^2\right\}.\]
    \item Pr\'ekopa-Leindler inequalityを$\lambda = 1/2$として使うために, 関数$u,v,w$を,
    \begin{align*}
        w(z) &= p(z) = \exp(-\psi(z)),\\
        u(x) &= \exp(-h(x)-\psi(x)),\\
        v(x) &= \exp(g(y)-\psi(y)),
    \end{align*}
    とする, ただし$p$は$\mathbb{P}$のdensityで, log-concavityより$\psi$はstorongly convex.
    \item (\ref{3.46})のRHSの$\log$をとったものを$R$とすると,
    \[ R = \frac{1}{2}\{g(y)-h(x)\} - \frac{1}{2}\psi(x)-\frac{1}{2}\psi(y)
    = \frac{1}{2}\{g(y)-h(x)-2E(x,y)\} - \psi(x/2+y/2), \]
    where $E(x,y):= \frac{1}{2}\psi(x)+\frac{1}{2}\psi(y)-\psi(x/2+y/2)$.
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item $\psi$がstrongly convexなので, $2E(x,y) \ge \frac{\gamma}{4}\|x-y\|_2^2$.
    \item これを代入すると,
    \[ R\le \frac{1}{2}\left\{g(y)-h(x)-\frac{\gamma}{4}\|x-y\|_2^2\right\}-\psi(x/2+y/2)\le -\psi(x/2+y/2)\]
    となる(ただし最後の不等号は$g$の定義より)ので, (\ref{3.46})は$\lambda=1/2$で満たされる.
    \item Pr\'ekopa-Leindler inequalityと$\int w(x)dx = \int p(x)dx = 1$より, (\ref{3.47})の$\log$をとって
    \[ 0 \ge \frac{1}{2}\log\int e^{-h(x)-\psi(x)}dx + \frac{1}{2}\log\int e^{g(y)-\psi(y)}dy. \]
    \item これを書き換えると,
    \[ \mathbb{E}[e^{g(Y)}]
    \leq \frac{1}{\mathbb{E}\left[e^{-h(X)}\right]}
    \stackrel{\mathrm{(i)}}{\leq} \frac{1}{e^{\mathbb{E}[-h(X)]}} \stackrel{\mathrm{(ii)}}{=} 1 \]
    となる, ただし$\mathrm{(i)}$はJensen, $\mathrm{(ii)}$は$\ex[h(X)]=0$より.
\end{itemize}
\end{frame}

\begin{frame}
\begin{itemize}
    \item また, $h$のLipschitz性$|h(x)-h(y)|\le L\|x-y\|_2$より,
    \begin{align*}
        g(y)
        =\inf _{x \in \mathbb{R}^{n}}\left\{h(x)+\frac{\gamma}{4}\|x-y\|_{2}^{2}\right\}
        &\geq h(y)+\inf _{x \in \mathbb{R}^{n}}\left\{-L\|x-y\|_{2}+\frac{\gamma}{4}\|x-y\|_{2}^{2}\right\} \\
        &=h(y)-\frac{L^{2}}{\gamma}.
    \end{align*}
    \item したがって, $\ex[e^h(X)] \le \exp(L^2/\gamma)$となる.\qed
\end{itemize}
\end{frame}

\end{document}