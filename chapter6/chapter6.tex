\documentclass[unicode,aspectratio=169,11pt]{beamer}
\usepackage{amsmath, amssymb, amsthm, color, latexsym, mathrsfs, bm}
\usefonttheme{professionalfonts}
\usepackage{luatexja}
\usepackage[ipaex]{luatexja-preset}
\renewcommand{\kanjifamilydefault}{\gtdefault}

\usetheme[
  sectionpage=none,
  numbering=fraction,
  block=fill
  ]{metropolis}

\def\qed{\hfill $\Box$}
\def\endexample{\hfill $\clubsuit$}
\newcommand{\ex}{\mathbb{E}}
\newcommand{\var}{\mathrm{var}}
\newcommand{\cov}{\mathrm{cov}}
\newcommand{\bb}{\mathbb}
\newcommand{\cc}{\mathcal}
\newcommand{\tr}{\mathrm{T}}
\newcommand{\trace}{\mathrm{tr}}


\title{6. Random matrices and covariance estimation}
\author{担当：みーとみ}
\date{2021年6月30日, 7月7日}


\begin{document}

\maketitle

\begin{frame}{Table of Contents}{}
    \setcounter{tocdepth}{1}
    \tableofcontents
\end{frame}

\section{6.1 Some preliminaries}
\begin{frame}{6.1 Some preliminaries}
  \begin{itemize}
    \item Notationとこの章で使うpreliminary resultsの説明から.
  \end{itemize}
\end{frame}

\subsection{6.1.1 Notation and basic facts}
\begin{frame}{6.1.1 Notation and basic facts}{}
  \begin{itemize}
    \item 行列 $A \in \bb{R}^{n \times m}$ with $n \ge m$ に対し, (順序付き)特異値を
    \[ \sigma_{\max}(A) = \sigma_1(A) \ge \sigma_2(A) \ge \dots \ge \sigma_m(A) = \sigma_{\min}(A) \ge 0 \]
    と書く.
    \item 最小・最大特異値は次のようにcharacterizeされる:
    \[ \sigma_{\max}(A) = \max_{\nu \in \bb{S}^{m-1}}\| A\nu \|_2 \quad \mathrm{and} \quad \sigma_{\min}(A) = \min_{\nu \in \bb{S}^{m-1}}\|A\nu\|_2, \tag{6.1} \]
    ただし $\bb{S}^{d-1} := \left\{ \nu \in \bb{R}^d \mid \|\nu\|_2 = 1 \right\}$ は $\bb{R}^d$ 上のEuclidean unit sphere.
    \item また次の同値性が成り立つ: $||| A |||_2 = \sigma_{\max}(A)$.
  \end{itemize}
\end{frame}

\begin{frame}
  \begin{itemize}
    \item 対称行列の集合を ${\cc{S}}^{d\times d} := \left\{Q\in\bb{R}^{d\times d} \mid Q = Q^\tr\right\}$ とし, その半正定値行列からなる部分集合を
    \[ \cc{S}_+^{d \times d} := \left\{Q \in \cc{S}^{d \times d} \mid Q \succeq 0\right\} \tag{6.2} \]
    と書く.
    \item 任意の対称行列 $Q \in \cc{S}^{d\times d}$ は対角化可能であり, その固有値を
    \[ \gamma_{\max}(Q) = \gamma_1(Q) \ge \gamma_2 \ge \dots \ge \gamma_d(Q) = \gamma_{\min}(Q) \]
    とする.
    \item このとき, $Q \succeq 0 \ \Leftrightarrow \ \gamma_{\min}(Q) \ge 0$.
  \end{itemize}
\end{frame}

\begin{frame}{}{}
  \begin{itemize}
    \item 最小・最大固有値の ``Rayleigh–Ritz variational characterization'':
    \[
        \gamma_{\max}(Q) = \max_{\nu \in \bb{S}^{d-1}} \nu^\tr Q \nu
        \quad \mathrm{and} \quad
        \gamma_{\min}(Q) = \min_{\nu \in \bb{S}^{d-1}} \nu^\tr Q \nu. \tag{6.3}
    \]
    \item 任意の対称行列 $Q$ に対し, その$\ell_2$-operator normは, 
    \[ |||Q|||_2 = \max \left\{ \gamma_{\max}(Q), |\gamma_{\min}(Q)| \right\} = \max_{\nu \in \bb{S}^{d-1}}\left|\nu^\tr Q\nu\right|.\tag{6.4} \]
    \item 最後に, 行列 $A \in \bb{R}^{n\times m}$ with $n \ge m$ に対し, $m$-次元対称行列 $R := A^\tr A$ を考えると, 
    \[ \gamma_j(R) = \left(\sigma_j(A)\right)^2 \quad \mathrm{for}\ j = 1, \dots, m. \]
  \end{itemize}
\end{frame}

\subsection{6.1.2 Set-up of covariance estimation}
\begin{frame}{6.1.2 Set-up of covariance estimation}{}
  \begin{itemize}
    \item $\{x_1,\dots,x_m\}$ は, $\bb{R}^d$上のzero-mean・covariance $\Sigma = \cov(x_1) \in \bb{S}_+^{d\times d}$なる分布からの $n$ 個のi.i.d.サンプルとする.
    \item $\Sigma$ のstandard estimatorは, 次の {\it sample covariance matrix} である:
    \[ \widehat{\Sigma} := \frac{1}{n}\sum_{i=1}^n x_i x_i^\tr.  \tag{6.5} \]
    \item 各 $x_i$ はzero-meanなので $\ex[x_i x_i^\tr] = \Sigma$ であり, $\widehat{\Sigma}$ は $\Sigma$ のunbiased estimator.
    \item したがって $\widehat{\Sigma}-\Sigma$ は期待値ゼロとなり, その$\ell_2$-operator normによって測ったerrorのboundを求めることがこの章のgoalとなる.
  \end{itemize}
\end{frame}

\begin{frame}
  \begin{itemize}
    \item (6.4) の$\ell_2$-operator normの表現より, $|||\widehat{\Sigma}-\Sigma|||_2 \le \epsilon$ は以下と同値:
    \[ \max_{\nu \in \bb{S}^{d-1}} \left|\frac{1}{n}\sum_{i=1}^n \langle x_i,\nu_i \rangle^2 - \nu^\tr \Sigma \nu\right| \le \epsilon. \tag{6.6}\]
    \item つまり, $|||\widehat{\Sigma} - \Sigma|||_2$ をコントロールすることは, $\nu$ でindexedされた関数クラス $x \mapsto \langle x, \nu\rangle^2$ のuniform law of large numbersを示すことと同値になる.
  \end{itemize}
\end{frame}

\begin{frame}{}{}
　\\
  \begin{itemize}
    \item その$\ell_2$-operator normをコントロールすることは, $\widehat{\Sigma}$ の固有値の一様収束も意味する: Weyl's theorem の corollaryより,
    \[ \max_{j = 1, \dots, d} \left|\gamma_j(\widehat{\Sigma}) - \gamma_j\left(\Sigma\right)\right| \le |||\widehat{\Sigma} - \Sigma|||_2. \tag{6.7} \]
    　\\
    \item また最後に, ランダム行列 $X \in \bb{R}^{n \times d}$ が, 第$i$行に $x_i^\tr$ を持つものとする
    \[
      X =
      \begin{pmatrix}
        x_1^\tr\\
        \vdots\\
        x_n^\tr
      \end{pmatrix} \in \bb{R}^{n \times d}
    \]
    と,
    \[ \widehat{\Sigma} = \frac{1}{n}\sum_{i=1}^n x_i x_i^\tr = \frac{1}{n}X^\tr X \]
    なので, $\widehat{\Sigma}$ の固有値は $X / \sqrt{n}$ の特異値の2乗となる.
  \end{itemize}
\end{frame}

\section{6.2 Wishart matrices and their behavior}
\begin{frame}{6.2 Wishart matrices and their behavior}
  \begin{itemize}
    \item サンプル $x_i$ は, $d$-次元正規分布 $\mathcal{N}(0, \Sigma)$ から i.i.d. で引かれるとする.
    \item このとき,
    \[
      X =
      \begin{pmatrix}
        x_1^\tr\\
        \vdots\\
        x_n^\tr
      \end{pmatrix} \in \bb{R}^{n \times d}
    \]
    は, {\it $\Sigma$-Gaussian ensemble} から引かれると言う.
    \item Sample covariance $\widehat{\Sigma} = \frac{1}{n}X^\tr X$ は, {a multivariate Wishart distribution} に従う.
  \end{itemize}
\end{frame}

\begin{frame}{}{}
  \begin{block}{Theorem 6.1}
    $X \in \mathbb{R}^{n \times d}$ は $\Sigma$-Gaussian ensembleから引かれるとする.
    このとき, 任意の $\delta > 0$ に対し, 最大特異値 $\sigma_{\max}(X)$ は以下のupper deviation inequalityを満たす:
    \[
      \bb{P} \left[
        \frac{\sigma_{\max}(X)}{\sqrt{n}}
        \ge \gamma_{\max}\left(\sqrt{\Sigma}\right) (1+\delta) + \sqrt{\frac{\trace(\Sigma)}{n}}
      \right]
      \le \exp\left(-\frac{n\delta^2}{2}\right).
      \tag{6.8}
    \]
    さらに$n \ge d$なら, 最小特異値 $\sigma_{\min}(X)$ は以下のlower deviation inequalityを満たす:
    \[
        \bb{P} \left[
        \frac{\sigma_{\min}(X)}{\sqrt{n}}
        \le \gamma_{\min}\left(\sqrt{\Sigma}\right) (1-\delta) - \sqrt{\frac{\trace(\Sigma)}{n}}
      \right]
      \le \exp\left(-\frac{n\delta^2}{2}\right).
      \tag{6.9}
    \]
  \end{block}
\end{frame}

\begin{frame}{}{}
　\\
{\bf Example 6.2} (Operator norm bounds for the standard Gaussian ensemble)
\begin{itemize}
  \item $W \in \bb{R}^{n \times d}$ は各成分が$\cc{N} (0,1)$ i.i.d.で引かれるrandom matrixとする（$\Sigma = I_d$）.
  \item Thm 6.1より, $n \ge d$ なら, 確率 $1 - 2 \exp\left(-\frac{n\delta^2}{2}\right)$ 以上で
  \[\frac{\sigma_{\max}(W)}{\sqrt{n}} \le 1 + \delta + \sqrt{\frac{d}{n}}
  \quad \mathrm{and} \quad
  \frac{\sigma_{\min}(W)}{\sqrt{n}} \ge 1 - \delta - \sqrt{\frac{d}{n}}
  \tag{6.10}
  \]
  となる.
  \item よって, 同じ確率で
  \[ \Bigg|\Bigg|\Bigg| \frac{1}{n}W^\tr W - I_d \Bigg|\Bigg|\Bigg|_2 \le 2\epsilon + \epsilon^2,
  \quad \mathrm{where} \epsilon = \sqrt{\frac{d}{n}} + \delta.
  \tag{6.11} \]
  \item したがって, $d/n \to 0$ なら, sample covariance $\widehat{\Sigma} = \frac{1}{n}W^\tr W$ はidentiry matrix $I_d$ の一致推定量となる.\endexample
\end{itemize}
\end{frame}

\begin{frame}{}{}
　\\
{\bf Example 6.3} (Gaussian covariance estimation)
\begin{itemize}
  \item $X \in \bb{R}^{n \times d}$ は$\Sigma$-Gaussian ensembleからのrandom matrixとする.
  \item このとき $X = W \sqrt{\Sigma}$ と書ける（$W \in \bb{R}^{n\times d}$はstandard Gaussian random matrix）ので,
          \[
              \Bigg|\Bigg|\Bigg| \frac{1}{n} X^\tr X - \Sigma \Bigg|\Bigg|\Bigg|_2
              = \Bigg|\Bigg|\Bigg|\sqrt{\Sigma}\left(\frac{1}{n}W^\tr W - I_d\right) \Bigg|\Bigg|\Bigg|_2
              \le |||\Sigma|||_2 \Bigg|\Bigg|\Bigg| \frac{1}{n} W^\tr W - I_d \Bigg|\Bigg|\Bigg|_2.
          \]
  \item したがって (6.11) より, 任意の $\delta > 0$ に対して確率 $1 - 2\exp\left(-\frac{n \delta^2}{2}\right)$ で
          \[
            \frac{||| \widehat{\Sigma} - \Sigma |||_2}{|||\Sigma|||_2}
            \le 2 \sqrt{\frac{d}{n}} + 2\delta + \left(\sqrt{\frac{d}{n}} + \delta\right)^2.
            \tag{6.12} 
          \]
  \item よって, $||| \widehat{\Sigma} - \Sigma |||_2 / |||\Sigma|||_2$ は $d/n \to 0$ である限り $0$ に収束する.\endexample
\end{itemize}
\end{frame}

\begin{frame}{}{}
　\\
{\bf Example 6.4} (Faster rates under trace constraints)
\begin{itemize}
  \item $\{ \gamma_j(\Sigma)\}_{j = 1}^d$ は$\Sigma$の固有値列で, $\gamma_1(\Sigma)$ がそのうち最大のもの.
  \item $\Sigma$は, 次元に対して独立な定数 $C$ に対し, 次の ``trace constraint'' を満たすとする:
        \[
            \frac{\trace(\Sigma)}{|||\Sigma|||_2}
            = \frac{\sum_{j=1}^d \gamma_j(\Sigma)}{\gamma_1(\Sigma)}
            \le C.
            \tag{6.13}
        \]
  \item $C$は$\Sigma$の（実質的な）rankと見なせる（$\because$ (6.13) は$C = \mathrm{rank}(\Sigma)$では常に成立. ）
  \item パラメータ $q \in [0,1]$と半径 $R_q >0$ のthe Schatten $q$-``balls''を, 以下で定義する:
        \[
          \bb{B}_q(R_q)
          := \left\{ \Sigma\in S^{d \times d} \Bigg| \sum_{j=1}^d|\gamma_j(\Sigma)|^q \le R_q \right\}.
          \tag{6.14}
        \]
        \begin{itemize}
          \item $q = 0$なら, rank $R_q$ 以下の対称行列の集合.
          \item $q = 1$なら, trace constraintになる.
        \end{itemize}
  \item 任意の非零行列 $\Sigma \in \bb{B}_q(R_q)$ は, (6.13) を $C = R_q / (\gamma_1(\Sigma))^q$ で満たす.
\end{itemize}
\end{frame}

\begin{frame}{}
\begin{itemize}
  \item (6.13) を満たす任意の$\Sigma$に対し, Thm 6.1は高確率で$X$の最大特異値が次のように抑えられることを保証する:
  \[
      \frac{\sigma_{\max}(X)}{\sqrt{n}} \le \gamma_{\max}(\sqrt{\Sigma}) \left(1 + \delta + \sqrt{\frac{C}{n}}\right).
      \tag{6.15}
  \]
  \item $\Sigma = I_d$のときのbound (6.10) と比べると, $C$ が $d$ に置き換わって``実行的なrank''となっている.\endexample
\end{itemize}
\end{frame}

\begin{frame}{}{}
{\bf Proof of Theorem 6.1.}
\end{frame}

\section{6.3 Covariance matrices from sub-Gaussian ensembles}
\begin{frame}{6.3 Covariance matrices from sub-Gaussian ensembles}{}
  \begin{itemize}
    \item 
  \end{itemize}
\end{frame}

\end{document}
